# Lighter 实盘交易设置指南

## ⚠️ 重要安全提醒
- **实盘交易涉及真实资金，请务必谨慎操作**
- 建议先用小额资金（如 10-50 USDT）进行测试
- 确保您已理解所有风险控制机制

## 1. 环境配置已完成 ✅

您的 `.env` 文件已配置：
```env
LIGHTER_API_KEY=87c2aea3128012c0b1973e3082d63ec7ed74d28f6a79e5524b2c3b0cab9bcd0b49e05cf580478a86
LIGHTER_PRIVATE_KEY=73656165c17bb60487616aa42fcbe57b13028d2189fdae5ae6fcb4d9f0dd885e430978c2a1c9b672
LIGHTER_API_KEY_INDEX=3
LIGHTER_HOST=https://mainnet.zklighter.elliot.ai/
MARKETS=BTC-USD:0,ETH-USD:1,SOL-USD:2
DRY_RUN=true  # 当前为模拟模式
```

## 2. 开始实盘交易的步骤

### 步骤 2.1：先运行模拟交易验证
```bash
# 确保当前是模拟模式
python main.py
```

观察运行情况，确认：
- 策略信号正常生成
- 交易逻辑执行正确
- 日志记录正常

### 步骤 2.2：切换到实盘模式
修改 `.env` 文件：
```env
DRY_RUN=false  # 改为 false 启用实盘交易
```

### 步骤 2.3：调整风险参数（可选）
在 `.env` 中添加更保守的设置：
```env
# 降低单笔交易风险
RISK_PER_TRADE=0.01  # 1% 风险（默认 2%）

# 降低杠杆
BASE_LEVERAGE=1.0     # 1x 杠杆（默认 2x）
MAX_LEVERAGE=2.0      # 最大 2x（默认 5x）
```

### 步骤 2.4：启动实盘交易
```bash
python main.py
```

## 3. 监控和管理

### 3.1 查看交易日志
```bash
# 查看交易记录
tail -f logs/trades.log

# 查看账户信息
tail -f logs/account.log

# 查看风险管理日志
tail -f logs/risk.log
```

### 3.2 紧急停止
如果需要立即停止所有交易：
1. 按 `Ctrl+C` 停止程序
2. 程序会自动取消所有未成交订单
3. 平仓所有持仓（根据配置）

## 4. 实盘交易检查清单

在切换到实盘前，请确认：

- [ ] Lighter 账户有足够资金（建议至少 100 USDT）
- [ ] API 密钥权限正确（需要交易权限）
- [ ] 已在模拟模式下成功运行至少 1 小时
- [ ] 了解止损机制工作原理
- [ ] 设置了合理的风险参数
- [ ] 准备好监控交易日志

## 5. 常见问题

### Q1: 如何知道交易是否成功？
A: 查看 `logs/trades.log`，会记录所有交易详情

### Q2: 如何调整交易策略？
A: 修改 `config/settings.py` 中的策略参数

### Q3: 如何只交易特定币种？
A: 修改 `.env` 中的 `MARKETS` 配置，例如只交易 BTC：
```env
MARKETS=BTC-USD:0
```

### Q4: 如何设置止损？
A: 系统会自动为每笔交易设置止损止盈单

### Q5: 出现异常怎么办？
A:
1. 立即停止程序（Ctrl+C）
2. 检查日志确定问题
3. 必要时手动在交易所处理持仓

## 6. 风险控制机制

您的系统已内置多重保护：
1. **单笔交易风险限制**：默认 2%
2. **最大回撤保护**：默认 15%
3. **连续亏损保护**：连续亏损后降低杠杆
4. **紧急平仓机制**：检测到异常时自动平仓

## 7. 下一步

1. 运行模拟交易验证
2. 确认一切正常后，设置 `DRY_RUN=false`
3. 用小额资金开始实盘
4. 逐步增加交易金额（如表现良好）

## 8. 联系支持

如遇到技术问题：
- 查看 Lighter DEX 官方文档
- 检查错误日志
- 可在项目 issues 中提问

---

**最后提醒**：加密货币交易风险极高，请仅投入您能承受损失的资金。